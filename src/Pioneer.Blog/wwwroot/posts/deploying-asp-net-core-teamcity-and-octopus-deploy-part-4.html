<!doctype html>
<html class="no-js" lang="">
<head>
  <link href="/app.css" rel="stylesheet" />
  <script src="/app.js"></script>
</head>
<body>
  <div class="row">
    <div class="large-10 large-push-1 columns">
      <h1>Deploying An ASP.NET Core Site: You're Still Doing It Wrong - Octopus Deploy Target Linux</h1>
      <article>
        <div class="note">
          <p>This day and age, predictability and reliability are two of the most important words when it comes deployment. In this series, I am going to talk about how to add predictability and reliability to your ASP.NET Core deployment pipeline using TeamCity and Octopus Deploy.</p>
          <ol style="margin-bottom: 0;">
            <li><a href="deploying-asp-net-core-teamcity-and-octopus-deploy-part-1">Intro</a></li>
            <li><a href="deploying-asp-net-core-teamcity-and-octopus-deploy-part-2">TeamCity</a></li>
            <li><a href="deploying-asp-net-core-teamcity-and-octopus-deploy-part-3">Octopus Deploy: Target Windows</a></li>
            <li><a href="deploying-asp-net-core-teamcity-and-octopus-deploy-part-4">Octopus Deploy: Target Linux</a></li>
            <li><a href="deploying-asp-net-core-teamcity-and-octopus-deploy-part-5">Database Migrations</a></li>
          </ol>
        </div>
        <h2>Creating A Project</h2>
        <blockquote>
          A project is a collection of deployment steps and configuration variables that you want Octopus to run during deployment. It's like a recipe - you define how the application is deployed, and then you create many releases to deploy different versions.
          <cite>OctousDeploy</cite>
        </blockquote>
        <p>Now that we have an "Environment" containing a "Target", we need to create a "Project" to that utilizes that "Target" for deployments. Head to the Projects page in your portal and click "Add Project". Assign it a Name, I called mine "Local IIS Deployment", and add a Description if you see fit. Click "Save" and you should end up at your newly created projects portal page.</p>
        <h3>Revisiting TeamCity: Pushing To Octopus</h3>
        <p>When we originally setup our "Build Configuration" inside TeamCity, we go to the point where TeamCity was restoring, building and publish our .NET Core application.  This process produced an artifact that was "scoped" to the TeamCity environment. We now need to take the process one step further and push those artifacts over to Octopus Deploy so that our Octopus Deploy Project can utilize them as it sees fit.</p>
        <p>The team at Octopus has made available a plugin that will help us with this build step. Head over to the <a href="https://octopus.com/downloads" target="_blank" title="Octopus Download">Octopus Download</a> page and deploy the plugin to your TeamCity server.  If you don't recall how to deploy plugins to TeamCity, you reference the "<a href="deploying-asp-net-core-teamcity-and-octopus-deploy-part-2">Installing "The" Plugin & .NET Core SDK</a>" section in <a href="deploying-asp-net-core-teamcity-and-octopus-deploy-part-2">Part 2</a> of this series.</p>
        <p>Once install, head back to your project Build Configuration and add a Build Step of the type "OctopusDeploy: Push Packages" as the last step in your build process.</p>
        <a href="/images/deploying-asp-net-core-teamcity-and-octopus-deploy/octo-revisit-1.png" title="TeamCity Octopus Push" target="_blank">
          <img src="/images/deploying-asp-net-core-teamcity-and-octopus-deploy/octo-revisit-1.png" alt="TeamCity Octopus Push" style="max-width: 1325px; border: 1px solid #ccc;" />
        </a>
        <ul>
          <li>
            Octopus Connection.
            <ul>
              <li>Add the URL to your Octopus install.</li>
              <li>
                Add the API Key to validate your connection.
                <ul>
                  <li>
                    This key is generated and obtained by and per users inside of Octopus.
                    <br />
                    <a href="/images/deploying-asp-net-core-teamcity-and-octopus-deploy/octo-revisit-2.png" title="TeamCity Octopus Push" target="_blank">
                      <img src="/images/deploying-asp-net-core-teamcity-and-octopus-deploy/octo-revisit-2.png" alt="TeamCity Octopus Push" style="max-width: 580px; border: 1px solid #ccc;" />
                    </a>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li>
            Packaged Paths
            <ul>
              <li>Define the contents and name of the package that the plugin will produce and push to Octopus</li>
            </ul>
          </li>
          <li>
            Publish packages as build artifacts
            <ul>
              <li>In <a href="deploying-asp-net-core-teamcity-and-octopus-deploy-part-2">Part 2</a> of this series, we had TeamCity create an artifact directly by setting the "Artifacts Path" value in the "General Settings" page.</li>
              <li>By selecting this checkbox, we can effectively remove that setting from "General Settings" and still get an accessible artifact inside of TeamCity.</li>
            </ul>
          </li>
        </ul>
        <p>Once you have this step configured, in TeamCity, manually tell your Project to "Run". If your new build step was setup correctly, you can view that Octopus Deploy received the artifact from TeamCity by heading the Configuration > Audit screen in the Octopus Deploy portal and looking a "pushed" log in your feed.</p>
        <a href="/images/deploying-asp-net-core-teamcity-and-octopus-deploy/octo-revisit-3.png" title="TeamCity Octopus Log" target="_blank">
          <img src="/images/deploying-asp-net-core-teamcity-and-octopus-deploy/octo-revisit-3.png" alt="TeamCity Octopus Log" style="max-width: 417px; border: 1px solid #ccc;" />
        </a>
        <h3>Deployment</h3>

        <h3>Variables: Configuring Our Deployment</h3>
        <blockquote>
          Variables contain the configuration values for an application that change as it's promoted from one environment to another.
          <cite>Octopus Deploy</cite>
        </blockquote>

        <h2>TeamCity</h2>
        <h2>Projects</h2>
        <h2>Up Next</h2>
      </article>
    </div>
  </div>
</body>
</html>
